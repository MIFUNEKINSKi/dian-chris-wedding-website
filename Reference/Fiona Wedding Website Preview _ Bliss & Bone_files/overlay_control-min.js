function calcOverlayHeight(e,t){sectionPadding=$(window).width()<=900?40:80,overlayHeight=winH>$("body").height()+headerHeightNum?otherOverlayH>winH?otherOverlayH:sectionHeight>winH?sectionHeight+2*sectionPadding+t:winH:otherOverlayH>$("body").height()-headerHeightNum?otherOverlayH:sectionHeight>$("body").height()-headerHeightNum?sectionHeight+2*sectionPadding+t:"auto",e.height(overlayHeight-sectionPadding)}function setOverlay(e,t){var i=t,n;sectionHeight=Number(e.find(".subsection").css("height").slice(0,-2)),console.log({sectionHeight:sectionHeight},{winH:winH}),sectionHeight>winH-150?(sectionHeight+=i=t-(.5*winH-headerHeightNum),calcOverlayHeight(e,i)):(sectionHeight+=i=t-.5*sectionHeight-headerHeightNum,calcOverlayHeight(e,i),console.log({topScrollTotal:i},{topScroll:t},{headerHeightNum:headerHeightNum})),e.find(".subsection").css("top",i),$(window).resize(),(mutObserver=new MutationObserver((function(t,n){sectionHeight=Number(e.find(".subsection").css("height").slice(0,-2)),sectionHeight+=i,calcOverlayHeight(e,i)}))).observe(e.find(".subsection")[0],{subtree:!0,childList:!0})}function openOverlay(e){var t=$("#"+e);winH=$(window).height();var i=$(window).scrollTop()+.5*winH;otherOverlayH=0,(mainContentBB=$('body > .section:not(.overlayEdit):not(#colorPicker), body > section, body > form, body > [id^="mainContent"], body > nav')).addClass("overlayIsOpen"),t.fadeIn(400,(function(){"imageEditOverlay"==t.attr("id")?setTimeout((function(){setOverlay(t,i)}),1e3):setOverlay(t,i)}))}function closeOverlay(e){e.hasClass("closeAll")?(mainContentBB.removeClass("overlayIsOpen"),mutObserver&&mutObserver.disconnect(),$(".overlayEdit").fadeOut(400,(function(){$(".overlayEdit").height("")}))):($(".overlayEdit").filter(":visible").length<=1&&(mainContentBB.removeClass("overlayIsOpen"),mutObserver&&mutObserver.disconnect()),e.fadeOut(400,(function(){e.height("")})))}function clickOpenOverlay(e){e.preventDefault(),overlay=$(this).attr("href"),openOverlay(overlay)}function testElemnt(e,t){var i;return t.some((function(t,i,n){return t==e}))}function submitOverlay(e){setTimeout((function(){e.find('button[type="submit"]').click()}),200)}function overlayFunctions(){$(".overlayEdit .subsection").each((function(e,t){testElemnt(t,overlaySubsections)||($(t).click((function(e){e.stopPropagation()})),overlaySubsections.push(t))})),$(".overlayOpen").each((function(e,t){testElemnt(t,overlayOpens)||($(t).on("click",clickOpenOverlay),overlayOpens.push(t))})),$(".overlayClose").each((function(e,t){testElemnt(t,overlayCloses)||($(t).click((function(){closeOverlay($(this).parents(".overlayEdit"))})),overlayCloses.push(t))})),$(".overlayEdit:not(.closeSpecial)").each((function(e,t){testElemnt(t,overlayEdits)||($(t).click((function(){closeOverlay($(this))})),overlayEdits.push(t))})),$(".overlayEdit.overlayFormInstantSubmit").each((function(e,t){testElemnt(t,overlaySubmit)||($(t).find("form label").click((function(){submitOverlay($(t).find("form"))})),$(t).find('form button[type="submit"]').hide(),overlaySubmit.push(t))}))}var sectionPadding,sectionHeight,overlayHeight,otherOverlayH,overlaySubsections=[],overlayOpens=[],overlayCloses=[],overlayEdits=[],overlaySubmit=[],winH,mainContentBB,mutObserver,headerHeightNum=/caratsandcake/.test(window.location.hostname)?60:106;$(document).ready((function(){overlayFunctions()}));